#:kivy 1.10.1

#:include authentication/widgets.kv # Maybe some widgets in new general file

<PopupConfigFolder>:
    title: "Config folder"

    tf_client_path: paths_container.tf_client_path
    tf_server_path: paths_container.tf_server_path
    # btn_save_add: btn_save_add

    WidgetsContainer:
        PathsContainer:
            id: paths_container
            canvas.before:
                Color:
                    rgba: (1, 0, .9, 1)
                Rectangle:
                    size: self.size
                    pos: self.pos

        PatternsContainer:
            canvas.before:
                Color:
                    rgba: (0, 0, 0, 1)
                Rectangle:
                    size: self.size
                    pos: self.pos

        MergeMethodsContainer:

        ConfigButtonsContainer:
            add: root.btn_release_add
            cancel: root.btn_release_cancel


<WidgetsContainer@BoxLayout>:
    orientation: "vertical"


<PathsContainer@StackLayout>:

    tf_client_path: client_path.tf_path
    tf_server_path: server_path.tf_path
    size_hint: 1, None

    Path:
        id: client_path
        text: "Local path: "
        browse: self.browse_client_path
        size_hint_x: 1

    Path:
        id: server_path
        text: "Remote path: "
        browse: self.browse_server_path
        size_hint_x: 1

<Path>:
    id: root_path
    text: ""
    browse: None
    height: 32
    size_hint: 1, None

    tf_path: tf_path

    Label:
        text: root_path.text
        size_hint: 0.2, 1

    TextInput:
        id: tf_path
        size_hint: 0.7, 1

    Button:
        text: "Browse"
        size_hint: 0.1, 1
        on_release: root.browse()

<ConfigButtonsContainer@ButtonsContainer>:

    add: None
    cancel: None

    ButtonGeneral:
        text: "Cancel"
        on_release: root.cancel()

    ButtonGeneral:
        text: "Add"
        on_release: root.add()

<PatternsContainer@BoxLayout>:
    orientation: "vertical"
    size_hint: 1, 1

    Patterns:
        id: include_patterns
        title: "Include patterns"

    Patterns:
        id: exclude_patterns
        title: "Exclude patterns"


<Patterns@BoxLayout>:
    orientation: "vertical"
    title: ""
    tf_file_extensions: file_extensions.tf_patterns
    tf_folders: folders.tf_patterns
    size_hint: 1, 1


    BoxLayout:
        padding: 20, 0, 0, 0

        Label:
            text: root.title
            size_hint: 1, None
            height: 30
            font_size: 20
            text_size:self.size
            halign:'left'
            valign:'middle'
            underline: True

    PatternsLine:
        id: file_extensions
        label: "File extensions: "
        hint_text: "e.g. .txt, .pdf"

    PatternsLine:
        id: folders
        label: "Folders: "
        hint_text: "e.g. folder1/, more/inner/"

    PatternsLine:
        id: advanced
        label: "Advanced regular expressions: "
        hint_text: "e.g. folder1\/.*\.txt"


<PatternsLine@BoxLayout>:
    label: ""
    hint_text: ""
    tf_patterns: tf_patterns
    size_hint: 1, None
    height: 32

    Label:
        text: root.label
        size_hint: 0.3, 1

    InputGeneral:
        id: tf_patterns
        hint_text: root.hint_text
        size_hint: 0.7, 1

<MergeMethodsContainer@StackLayout>:
    size_hint: 1, None
    height: 30

    Label:
        text: "Merge Method: "
        size_hint: 0.2, 1

    MergeMethods:

<MergeMethods>:
    size_hint: 0.4, 1
    dropdown: dropdown

    Button:
        id: btn
        text: 'Merge Method'
        on_parent: dropdown.dismiss()
        on_release: dropdown.open(self)
        height: 35

    DropDown:
        id: dropdown
        on_select: btn.text = '{}'.format(args[1])

<MergeMethodItem>:
    size_hint_y: None
    height: 35


<PopupBrowseServerFolder>
    title: "Browse server folder"
    auto_dismiss: False

    foldersView: foldersView

    BoxLayout:
        orientation: "vertical"

        FoldersView:
            id: foldersView

        Button:
            text: "Select"
            on_release: root.set_server_path()

        Button:
            text: "Cancel"
            on_release: root.dismiss()


<FoldersView>:
    viewclass: 'SelectableLabel'
    text_selected: ''
    name_selected: ''

    SelectableRecycleBoxLayout:
        id: culture_sub_view_layout
        orientation: 'vertical'
        default_size: None, dp(32)
        default_size_hint: .6, None
        size_hint: 1, .9
        multiselect: False
        touch_multiselect: False


<SelectableLabel>:
    canvas.before:
        Color:
            rgba: (.05, 0.5, .9, .8) if self.selected else (.5, .5, .5, 1)
        Rectangle:
            pos: self.pos
            size: self.size

